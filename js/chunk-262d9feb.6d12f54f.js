(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-262d9feb"],{"8cc8":function(t,e,r){"use strict";r("c5a1")},c5a1:function(t,e,r){},ed05:function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-card",{staticClass:"alert-indicator",on:{click:function(e){return t.selectAsi()}}},[r("v-card-text",{staticClass:"pa-0",style:{"background-color":t.severityColor(t.maxSeverity)}},[r("div",{staticClass:"text-uppercase text-xs-center py-2"},[t._v(" "+t._s(t.title)+" ")])]),r("v-card-actions",{staticClass:"pa-0 mx-0",style:{"background-color":t.isDark?"":"#F5F5F5"}},[r("v-layout",[r("v-flex",[r("div",{staticClass:"counts-container"},[t.counts?r("v-layout",{attrs:{"align-start":"","justify-space-between":""}},t._l(t.$config.indicators.severity,(function(e){return r("div",{key:e,staticClass:"count text-xs-center py-2",style:{"background-color":t.severityColor(e)}},[t._v(" "+t._s(t.counts[e]||0)+" ")])})),0):t._e()],1)])],1)],1)],1)},n=[],i=r("b85c"),a=(r("d3b7"),r("3ca3"),r("ddb0"),r("9861"),r("4e08")),c={props:{title:{type:String,default:""},query:{type:[String,Array,Object],default:""}},data:function(){return{counts:null,openCounts:null,maxSeverity:null,timer:null}},computed:{isDark:function(){return this.$store.getters.getPreference("isDark")},refresh:function(){return this.$store.state.refresh},refreshInterval:function(){return this.$store.getters.getPreference("refreshInterval")||this.$store.getters.getConfig("refresh_interval")}},watch:{refresh:function(t){t&&(this.getMostSevere(),this.getCounts())}},created:function(){this.cancelTimer(),this.refreshCounts()},beforeDestroy:function(){this.cancelTimer()},methods:{selectAsi:function(){this.setSearch(new URLSearchParams(this.query)),this.setFilter(new URLSearchParams(this.query)),this.refreshList()},setSearch:function(t){this.$store.dispatch("alerts/updateQuery",t)},setFilter:function(t){this.$store.dispatch("alerts/setFilter",{environment:t.get("environment"),text:t.get("text"),status:t.has("status")?t.getAll("status"):null,customer:t.has("customer")?t.getAll("customer"):null,service:t.has("service")?t.getAll("service"):null,group:t.has("group")?t.getAll("group"):null})},severityColor:function(t){return this.counts&&this.counts[t]>0?this.$store.getters.getConfig("colors").severity[t]:"transparent"},getCounts:function(){var t=this;return a["a"].getCounts(new URLSearchParams(this.query)).then((function(e){return t.counts=e.severityCounts}))},getMostSevere:function(){var t=this,e=new URLSearchParams(this.query);e.append("status","open"),a["a"].getCounts(e).then((function(e){t.maxSeverity=t.$config.alarm_model.defaults.normal_severity;var r,s=Object(i["a"])(t.$config.indicators.severity);try{for(s.s();!(r=s.n()).done;){var n=r.value;if(e.severityCounts[n]>0){t.maxSeverity=n;break}}}catch(a){s.e(a)}finally{s.f()}}))},refreshCounts:function(){var t=this;this.getMostSevere(),this.getCounts().then((function(){return t.timer=setTimeout((function(){return t.refreshCounts()}),t.refreshInterval)}))},refreshList:function(){var t=this;this.$store.dispatch("set",["refresh",!0]),setTimeout((function(){t.$store.dispatch("set",["refresh",!1])}),300)},cancelTimer:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}}},o=c,u=(r("8cc8"),r("2877")),l=r("6544"),h=r.n(l),f=r("b0af"),v=r("99d9"),d=r("0e8f"),g=r("a722"),y=Object(u["a"])(o,s,n,!1,null,"2fffb3c6",null);e["default"]=y.exports;h()(y,{VCard:f["a"],VCardActions:v["a"],VCardText:v["b"],VFlex:d["a"],VLayout:g["a"]})}}]);
//# sourceMappingURL=chunk-262d9feb.6d12f54f.js.map